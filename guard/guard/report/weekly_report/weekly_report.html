{%
	var report_columns = report.get_columns_for_print();
	report_columns = report_columns.filter(col => !col.hidden);

	if (report_columns.length > 15) {
		frappe.throw(__("Too many columns. Export the report and print it using a spreadsheet application."));
	}
	var previous_site = null;
%}

<style>
    .custom-report {
        width: 100%;
        border-collapse: collapse;
		border-spacing: 0; 
        table-layout: fixed;
    }
    .custom-report th,
    .custom-report td {
		padding: 2px;
		margin: 0;
        text-align: left;
        word-wrap: break-word;
    }

    .custom-report th {
        background-color: #6967f1;
        color: white;
    }

	.custom-report th:nth-child(1),
    .custom-report td:nth-child(1) {
        width: 30%;
    }

    .custom-report th:nth-child(2),
    .custom-report td:nth-child(2) {
        width: 30%;
    }

    .custom-report-blank-row td {
        height: 25px;
    }

    .custom-report tr:nth-child(even) {
        background-color: #f9f9f9;
    }

	.custom-report td:last-child {
    text-align: left;
	}
    .page-break {
        page-break-after: always;
    }
</style>

{% for row in data %}
	<table class="table table-borderless custom-report">
	{%
		if (row.site && row.site != previous_site) {
			previous_site = row.site;
	%}
		
		<div class="page-break"></div>
		<br>
		<h3 class="text-center">{%= __("Timesheet for week {0} - {1}", [filters.from_date, filters.to_date]) %} - {%= row.site %}</h3>
		<hr>
		
		<thead>
			<tr>
				{% for col in report_columns %}
					<th>{%= col.label %}</th>
				{% endfor %}
			</tr>
		</thead>
	{%
		}
	%}


		<tbody>
			{%
				var row_class = row.employee ? "" : "custom-report-blank-row";
			%}
			<tr class="{%= row_class %}">
				{% for col in report_columns %}
					<td>{%= frappe.format(row[col.fieldname], col, {}, row) %}</td>
				{% endfor %}
			</tr>
		</tbody>
	</table>
{% endfor %}

<p class="text-right text-muted">
	Printed On {%= frappe.datetime.str_to_user(frappe.datetime.get_datetime_as_string()) %}
</p>
